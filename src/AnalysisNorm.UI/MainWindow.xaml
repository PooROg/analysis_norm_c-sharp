<Window x:Class="AnalysisNorm.UI.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:d="http://schemas.microsoft.com/expression/blend/2008"
        xmlns:mc="http://schemas.openxmlformats.org/markup-compatibility/2006"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:controls="clr-namespace:AnalysisNorm.UI.Controls"
        mc:Ignorable="d"
        Title="Анализатор норм расхода электроэнергии РЖД" 
        Height="900" Width="1400" MinHeight="700" MinWidth="1000"
        WindowStartupLocation="CenterScreen"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="13"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Window.Resources>
        <!-- Стили для секций в соответствии с Python tkinter layout -->
        <Style x:Key="SectionStyle" TargetType="materialDesign:Card">
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="8"/>
            <Setter Property="materialDesign:ElevationAssist.Elevation" Value="Dp2"/>
        </Style>
        
        <!-- Стили для заголовков секций аналогично Python ttk.LabelFrame -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Foreground" Value="{DynamicResource MaterialDesignBody}"/>
            <Setter Property="Margin" Value="0,0,0,12"/>
        </Style>

        <!-- Стили для кнопок секций -->
        <Style x:Key="SectionButtonStyle" TargetType="Button" BasedOn="{StaticResource MaterialDesignRaisedButton}">
            <Setter Property="Margin" Value="4"/>
            <Setter Property="Padding" Value="16,8"/>
            <Setter Property="HorizontalAlignment" Value="Stretch"/>
        </Style>

        <!-- Стили статуса аналогично Python style_config -->
        <Style x:Key="SuccessTextStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Green"/>
            <Setter Property="FontWeight" Value="Medium"/>
        </Style>
        
        <Style x:Key="ErrorTextStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Red"/>
            <Setter Property="FontWeight" Value="Medium"/>
        </Style>
        
        <Style x:Key="WarningTextStyle" TargetType="TextBlock">
            <Setter Property="Foreground" Value="Orange"/>
            <Setter Property="FontWeight" Value="Medium"/>
        </Style>
    </Window.Resources>

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <!-- Файловая секция - соответствует Python file_frame row=0 -->
            <RowDefinition Height="Auto"/>
            <!-- Главные секции - соответствует Python control_frame + viz_frame row=1 -->
            <RowDefinition Height="*"/>
            <!-- Журнал операций - соответствует Python log_frame row=2 -->
            <RowDefinition Height="200"/>
        </Grid.RowDefinitions>

        <!-- Файловая секция (Аналог Python FileSection) -->
        <materialDesign:Card Grid.Row="0" Style="{StaticResource SectionStyle}">
            <controls:FileSectionControl />
        </materialDesign:Card>

        <!-- Основная рабочая область -->
        <Grid Grid.Row="1" Margin="0,8">
            <Grid.ColumnDefinitions>
                <!-- Секция управления - соответствует Python control_frame -->
                <ColumnDefinition Width="480"/>
                <!-- Секция визуализации - соответствует Python viz_frame -->
                <ColumnDefinition Width="*"/>
            </Grid.ColumnDefinitions>

            <!-- Секция управления анализом (Аналог Python ControlSection) -->
            <materialDesign:Card Grid.Column="0" Style="{StaticResource SectionStyle}">
                <controls:ControlSectionControl />
            </materialDesign:Card>

            <!-- Секция визуализации (Аналог Python VisualizationSection) -->
            <materialDesign:Card Grid.Column="1" Style="{StaticResource SectionStyle}">
                <controls:VisualizationSectionControl />
            </materialDesign:Card>
        </Grid>

        <!-- Журнал операций (Аналог Python log_text) -->
        <materialDesign:Card Grid.Row="2" Style="{StaticResource SectionStyle}">
            <DockPanel>
                <StackPanel DockPanel.Dock="Top" Orientation="Horizontal">
                    <TextBlock Text="Журнал операций" Style="{StaticResource SectionHeaderStyle}"/>
                    <Button Content="Очистить логи" 
                            Command="{Binding ClearLogsCommand}"
                            Style="{StaticResource MaterialDesignOutlinedButton}"
                            Margin="16,0,0,0" Padding="12,4" FontSize="11"
                            VerticalAlignment="Center"/>
                </StackPanel>
                
                <!-- Текстовое поле логов с прокруткой аналогично Python Text widget -->
                <ScrollViewer VerticalScrollBarVisibility="Auto" 
                              HorizontalScrollBarVisibility="Auto">
                    <TextBox Text="{Binding LogText, Mode=OneWay}"
                             IsReadOnly="True"
                             TextWrapping="Wrap"
                             AcceptsReturn="True"
                             Background="Transparent"
                             BorderThickness="0"
                             FontFamily="Consolas"
                             FontSize="11"
                             Padding="8"/>
                </ScrollViewer>
            </DockPanel>
        </materialDesign:Card>

        <!-- Overlay для прогресса загрузки -->
        <Grid Grid.RowSpan="3" Background="#AA000000" 
              Visibility="{Binding IsLoading, Converter={StaticResource BooleanToVisibilityConverter}}">
            <StackPanel HorizontalAlignment="Center" VerticalAlignment="Center"
                        Background="{DynamicResource MaterialDesignPaper}"
                        Width="300" Height="150">
                <materialDesign:PackIcon Kind="Loading" Width="48" Height="48"
                                        Foreground="{DynamicResource MaterialDesignBody}"
                                        HorizontalAlignment="Center" Margin="0,20,0,16">
                    <materialDesign:PackIcon.RenderTransform>
                        <RotateTransform x:Name="LoadingRotation"/>
                    </materialDesign:PackIcon.RenderTransform>
                    <materialDesign:PackIcon.Triggers>
                        <EventTrigger RoutedEvent="Loaded">
                            <BeginStoryboard>
                                <Storyboard RepeatBehavior="Forever">
                                    <DoubleAnimation Storyboard.TargetName="LoadingRotation"
                                                   Storyboard.TargetProperty="Angle"
                                                   From="0" To="360" Duration="0:0:1"/>
                                </Storyboard>
                            </BeginStoryboard>
                        </EventTrigger>
                    </materialDesign:PackIcon.Triggers>
                </materialDesign:PackIcon>
                
                <TextBlock Text="{Binding LoadingMessage}" 
                          HorizontalAlignment="Center"
                          FontSize="14" FontWeight="Medium"/>
                          
                <ProgressBar Value="{Binding LoadingProgress}" Maximum="100"
                           Margin="20,12,20,20" Height="6"/>
            </StackPanel>
        </Grid>
    </Grid>
</Window>