<UserControl x:Class="AnalysisNorm.UI.Controls.ControlSectionControl"
             xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
             xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
             xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes">

    <materialDesign:Card Padding="16" 
                        Margin="8"
                        materialDesign:ElevationAssist.Elevation="Dp2">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="Auto"/>
                <RowDefinition Height="*"/>
            </Grid.RowDefinitions>

            <!-- Заголовок секции -->
            <TextBlock Grid.Row="0"
                       Text="Управление анализом"
                       Style="{StaticResource MaterialDesignHeadline6TextBlock}"
                       Margin="0,0,0,16"/>

            <!-- Ввод названия участка -->
            <TextBox Grid.Row="1"
                     x:Name="SectionInputTextBox"
                     materialDesign:HintAssist.Hint="Введите название участка"
                     materialDesign:TextFieldAssist.DecorationVisibility="Visible"
                     materialDesign:TextFieldAssist.UnderlineBrush="{DynamicResource MaterialDesignDivider}"
                     Style="{StaticResource MaterialDesignOutlinedTextBox}"
                     Margin="0,8"
                     FontSize="14"
                     Text="{Binding SelectedSection, UpdateSourceTrigger=PropertyChanged}"/>

            <!-- Выбор нормы -->
            <ComboBox Grid.Row="2"
                      x:Name="NormSelectionComboBox"
                      materialDesign:HintAssist.Hint="Выберите норму расхода"
                      materialDesign:ComboBoxAssist.MaxLength="10"
                      Style="{StaticResource MaterialDesignComboBox}"
                      Margin="0,8"
                      ItemsSource="{Binding AvailableNorms}"
                      SelectedItem="{Binding SelectedNorm}"
                      DisplayMemberPath="NormId"
                      IsEnabled="{Binding IsNormSelectionEnabled}"/>

            <!-- Опции анализа -->
            <StackPanel Grid.Row="3" Orientation="Vertical" Margin="0,16,0,8">
                <CheckBox x:Name="SingleSectionOnlyCheckBox"
                          Content="Анализировать только выбранный участок"
                          IsChecked="{Binding SingleSectionOnly}"
                          Style="{StaticResource MaterialDesignCheckBox}"
                          Margin="0,4"/>
                
                <CheckBox x:Name="IncludeStatisticsCheckBox"
                          Content="Включить детальную статистику"
                          IsChecked="{Binding IncludeStatistics}"
                          Style="{StaticResource MaterialDesignCheckBox}"
                          Margin="0,4"/>
                
                <CheckBox x:Name="UseCoefficientsCheckBox"
                          Content="Применять коэффициенты локомотивов"
                          IsChecked="{Binding UseCoefficients}"
                          Style="{StaticResource MaterialDesignCheckBox}"
                          Margin="0,4"/>
            </StackPanel>

            <!-- Кнопки управления -->
            <StackPanel Grid.Row="4" 
                        Orientation="Horizontal" 
                        HorizontalAlignment="Right"
                        VerticalAlignment="Bottom"
                        Margin="0,16,0,0">
                
                <Button x:Name="StartAnalysisButton"
                        Style="{StaticResource MaterialDesignRaisedButton}"
                        Content="Начать анализ"
                        Command="{Binding StartAnalysisCommand}"
                        IsEnabled="{Binding CanStartAnalysis}"
                        Margin="0,0,8,0"
                        Padding="16,8">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="PlayCircleOutline" 
                                                   Width="16" 
                                                   Height="16" 
                                                   Margin="0,0,8,0"/>
                            <TextBlock Text="Начать анализ" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button.Content>
                </Button>

                <Button x:Name="StopAnalysisButton"
                        Style="{StaticResource MaterialDesignOutlinedButton}"
                        Content="Остановить"
                        Command="{Binding StopAnalysisCommand}"
                        IsEnabled="{Binding CanStopAnalysis}"
                        Padding="16,8">
                    <Button.Content>
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="StopCircleOutline" 
                                                   Width="16" 
                                                   Height="16" 
                                                   Margin="0,0,8,0"/>
                            <TextBlock Text="Остановить" VerticalAlignment="Center"/>
                        </StackPanel>
                    </Button.Content>
                </Button>
            </StackPanel>
        </Grid>
    </materialDesign:Card>

</UserControl>