<Window x:Class="AnalysisNorm.UI.Windows.RouteStatisticsWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="Статистика маршрутов" 
        Height="700" Width="900"
        WindowStartupLocation="CenterOwner"
        ResizeMode="CanResizeWithGrip"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Grid Margin="16">
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/>
            <RowDefinition Height="*"/>
            <RowDefinition Height="Auto"/>
        </Grid.RowDefinitions>

        <!-- Заголовок и общая информация -->
        <materialDesign:Card Grid.Row="0" 
                             Padding="16" 
                             Margin="0,0,0,12"
                             materialDesign:ElevationAssist.Elevation="Dp2">
            <StackPanel>
                <TextBlock Text="Подробная статистика маршрутов" 
                           FontSize="18" 
                           FontWeight="SemiBold"
                           HorizontalAlignment="Center"
                           Margin="0,0,0,8"/>
                
                <TextBlock Text="{Binding GeneralInfo}" 
                           FontSize="13"
                           TextAlignment="Center"
                           Foreground="{DynamicResource MaterialDesignBodyLight}"/>
            </StackPanel>
        </materialDesign:Card>

        <!-- Основное содержимое в табах -->
        <materialDesign:Card Grid.Row="1" 
                             materialDesign:ElevationAssist.Elevation="Dp1"
                             Margin="0,0,0,12">
            
            <TabControl Style="{StaticResource MaterialDesignTabControl}">
                
                <!-- Общая статистика - аналог Python general statistics -->
                <TabItem Header="Общая статистика">
                    <ScrollViewer Padding="16" VerticalScrollBarVisibility="Auto">
                        <TextBox Text="{Binding GeneralStatistics, Mode=OneWay}"
                                 IsReadOnly="True"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 FontFamily="Consolas"
                                 FontSize="12"/>
                    </ScrollViewer>
                </TabItem>

                <!-- Статистика по участкам - аналог Python sections statistics -->
                <TabItem Header="По участкам">
                    <ScrollViewer Padding="16" VerticalScrollBarVisibility="Auto">
                        <TextBox Text="{Binding SectionStatistics, Mode=OneWay}"
                                 IsReadOnly="True"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 FontFamily="Consolas"
                                 FontSize="12"/>
                    </ScrollViewer>
                </TabItem>

                <!-- Статистика по локомотивам - аналог Python locomotive statistics -->
                <TabItem Header="По локомотивам">
                    <ScrollViewer Padding="16" VerticalScrollBarVisibility="Auto">
                        <TextBox Text="{Binding LocomotiveStatistics, Mode=OneWay}"
                                 IsReadOnly="True"
                                 TextWrapping="Wrap"
                                 AcceptsReturn="True"
                                 Background="Transparent"
                                 BorderThickness="0"
                                 FontFamily="Consolas"
                                 FontSize="12"/>
                    </ScrollViewer>
                </TabItem>

                <!-- Категории отклонений - аналог Python deviation categories -->
                <TabItem Header="Отклонения">
                    <ScrollViewer Padding="16" VerticalScrollBarVisibility="Auto">
                        <StackPanel>
                            <!-- Круговая диаграмма категорий отклонений -->
                            <TextBlock Text="Распределение категорий отклонений:" 
                                       FontWeight="SemiBold" 
                                       Margin="0,0,0,12"/>
                            
                            <!-- Placeholder для будущей круговой диаграммы -->
                            <Border Background="LightGray" 
                                    Height="200" 
                                    CornerRadius="4"
                                    Margin="0,0,0,16">
                                <TextBlock Text="Круговая диаграмма\n(будет добавлена в следующей версии)" 
                                           HorizontalAlignment="Center"
                                           VerticalAlignment="Center"
                                           TextAlignment="Center"
                                           Foreground="Gray"/>
                            </Border>

                            <!-- Детальная статистика отклонений -->
                            <TextBox Text="{Binding DeviationStatistics, Mode=OneWay}"
                                     IsReadOnly="True"
                                     TextWrapping="Wrap"
                                     AcceptsReturn="True"
                                     Background="Transparent"
                                     BorderThickness="0"
                                     FontFamily="Consolas"
                                     FontSize="12"/>
                        </StackPanel>
                    </ScrollViewer>
                </TabItem>
            </TabControl>
        </materialDesign:Card>

        <!-- Кнопки действий -->
        <StackPanel Grid.Row="2" 
                    Orientation="Horizontal" 
                    HorizontalAlignment="Right">
            
            <Button Content="Экспорт в Excel"
                    Command="{Binding ExportStatisticsCommand}"
                    Style="{StaticResource MaterialDesignOutlinedButton}"
                    Padding="16,8"
                    Margin="0,0,8,0">
                <Button.ContentTemplate>
                    <DataTemplate>
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="FileExcel" 
                                                    Width="16" Height="16"
                                                    VerticalAlignment="Center"
                                                    Margin="0,0,6,0"/>
                            <TextBlock Text="{Binding}" VerticalAlignment="Center"/>
                        </StackPanel>
                    </DataTemplate>
                </Button.ContentTemplate>
            </Button>

            <Button Content="Закрыть"
                    Click="CloseWindow_Click"
                    Style="{StaticResource MaterialDesignRaisedButton}"
                    Padding="20,8"/>
        </StackPanel>
    </Grid>
</Window>