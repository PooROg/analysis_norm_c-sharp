<Window x:Class="AnalysisNorm.Views.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        xmlns:viewModels="clr-namespace:AnalysisNorm.ViewModels"
        Title="Анализатор норм расхода электроэнергии РЖД v1.0"
        MinWidth="1200" MinHeight="800"
        Width="1400" Height="900"
        WindowStartupLocation="CenterScreen"
        TextElement.Foreground="{DynamicResource MaterialDesignBody}"
        TextElement.FontWeight="Regular"
        TextElement.FontSize="14"
        TextOptions.TextFormattingMode="Ideal"
        TextOptions.TextRenderingMode="Auto"
        Background="{DynamicResource MaterialDesignPaper}"
        FontFamily="{DynamicResource MaterialDesignFont}">

    <Window.Resources>
        <!-- Локальные стили для главного окна -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
            <Setter Property="Foreground" Value="{DynamicResource PrimaryHueMidBrush}"/>
        </Style>
        
        <Style x:Key="StatusBarTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="8,0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>
    </Window.Resources>

    <materialDesign:DialogHost Identifier="MainDialogHost">
        <Grid>
            <Grid.RowDefinitions>
                <RowDefinition Height="Auto"/> <!-- Toolbar -->
                <RowDefinition Height="*"/>    <!-- Main Content -->
                <RowDefinition Height="Auto"/> <!-- Status Bar -->
            </Grid.RowDefinitions>

            <!-- Toolbar -->
            <materialDesign:Card Grid.Row="0" Margin="8,8,8,4" 
                               materialDesign:ShadowAssist.ShadowDepth="Depth1">
                <StackPanel Orientation="Horizontal" Margin="16,8">
                    <materialDesign:PackIcon Kind="Analytics" Width="24" Height="24" 
                                           VerticalAlignment="Center" Margin="0,0,8,0"/>
                    <TextBlock Text="Анализатор норм расхода электроэнергии РЖД" 
                             Style="{StaticResource SectionHeaderStyle}"
                             VerticalAlignment="Center"/>
                    
                    <!-- Spacer -->
                    <Border Width="32"/>
                    
                    <!-- Quick Actions -->
                    <Button Style="{StaticResource MaterialDesignFlatButton}"
                            Command="{Binding ShowDiagnosticsCommand}"
                            ToolTip="Показать диагностическую панель">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Monitor" Width="16" Height="16" Margin="0,0,4,0"/>
                            <TextBlock Text="Диагностика"/>
                        </StackPanel>
                    </Button>
                    
                    <Button Style="{StaticResource MaterialDesignFlatButton}"
                            Command="{Binding ShowAboutCommand}"
                            ToolTip="О программе">
                        <StackPanel Orientation="Horizontal">
                            <materialDesign:PackIcon Kind="Information" Width="16" Height="16" Margin="0,0,4,0"/>
                            <TextBlock Text="О программе"/>
                        </StackPanel>
                    </Button>
                </StackPanel>
            </materialDesign:Card>

            <!-- Main Content Area -->
            <Grid Grid.Row="1" Margin="8,4,8,4">
                <Grid.ColumnDefinitions>
                    <ColumnDefinition Width="350"/> <!-- Left Panel -->
                    <ColumnDefinition Width="8"/>   <!-- Splitter -->
                    <ColumnDefinition Width="*"/>   <!-- Right Panel -->
                </Grid.ColumnDefinitions>

                <!-- Left Panel - Controls and Configuration -->
                <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                    <StackPanel>
                        
                        <!-- File Section Placeholder -->
                        <materialDesign:Card Margin="0,0,0,8" 
                                           materialDesign:ShadowAssist.ShadowDepth="Depth2">
                            <Expander Header="Файлы данных" IsExpanded="True"
                                    materialDesign:ExpanderAssist.HorizontalHeaderPadding="16,8">
                                <StackPanel Margin="16">
                                    <TextBlock Text="HTML файлы маршрутов:" Style="{StaticResource MaterialDesignSubtitle2TextBlock}"/>
                                    <TextBlock Text="Не выбраны" Foreground="Gray" Margin="0,4,0,8"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                        <Button Content="Выбрать файлы" 
                                              Style="{StaticResource MaterialDesignRaisedButton}"
                                              Margin="0,0,8,0"/>
                                        <Button Content="Очистить" 
                                              Style="{StaticResource MaterialDesignOutlinedButton}"/>
                                    </StackPanel>
                                    
                                    <TextBlock Text="HTML файлы норм:" Style="{StaticResource MaterialDesignSubtitle2TextBlock}"/>
                                    <TextBlock Text="Не выбраны" Foreground="Gray" Margin="0,4,0,8"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                        <Button Content="Выбрать файлы" 
                                              Style="{StaticResource MaterialDesignRaisedButton}"
                                              Margin="0,0,8,0"/>
                                        <Button Content="Очистить" 
                                              Style="{StaticResource MaterialDesignOutlinedButton}"/>
                                    </StackPanel>
                                    
                                    <StackPanel Orientation="Horizontal">
                                        <Button Content="Загрузить маршруты" 
                                              Style="{StaticResource MaterialDesignRaisedButton}"
                                              IsEnabled="False" Margin="0,0,8,0"/>
                                        <Button Content="Загрузить нормы" 
                                              Style="{StaticResource MaterialDesignRaisedButton}"
                                              IsEnabled="False"/>
                                    </StackPanel>
                                </StackPanel>
                            </Expander>
                        </materialDesign:Card>

                        <!-- Analysis Section Placeholder -->
                        <materialDesign:Card Margin="0,0,0,8" 
                                           materialDesign:ShadowAssist.ShadowDepth="Depth2">
                            <Expander Header="Управление анализом" IsExpanded="True"
                                    materialDesign:ExpanderAssist.HorizontalHeaderPadding="16,8">
                                <StackPanel Margin="16">
                                    <TextBlock Text="Участок:" Style="{StaticResource MaterialDesignSubtitle2TextBlock}"/>
                                    <ComboBox materialDesign:HintAssist.Hint="Выберите участок для анализа"
                                            Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                                            Margin="0,0,0,16" IsEnabled="False"/>
                                    
                                    <CheckBox Content="Только маршруты с одним участком" 
                                            IsEnabled="False" Margin="0,0,0,16"/>
                                    
                                    <TextBlock Text="Норма (опционально):" Style="{StaticResource MaterialDesignSubtitle2TextBlock}"/>
                                    <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                        <ComboBox materialDesign:HintAssist.Hint="Все нормы"
                                                Style="{StaticResource MaterialDesignFloatingHintComboBox}"
                                                MinWidth="200" IsEnabled="False" Margin="0,0,8,0"/>
                                        <Button Content="Инфо о норме" 
                                              Style="{StaticResource MaterialDesignOutlinedButton}"
                                              IsEnabled="False"/>
                                    </StackPanel>
                                    
                                    <TextBlock Text="Участок: 0 маршрутов" 
                                             Foreground="Orange" Margin="0,0,0,16"/>
                                    
                                    <Button Content="Анализировать участок" 
                                          Style="{StaticResource MaterialDesignRaisedButton}"
                                          IsEnabled="False" Margin="0,0,0,8"/>
                                    <Button Content="Фильтр локомотивов" 
                                          Style="{StaticResource MaterialDesignOutlinedButton}"
                                          IsEnabled="False" Margin="0,0,0,8"/>
                                    <Button Content="Редактировать нормы" 
                                          Style="{StaticResource MaterialDesignOutlinedButton}"
                                          IsEnabled="False"/>
                                </StackPanel>
                            </Expander>
                        </materialDesign:Card>

                        <!-- Performance Monitor -->
                        <materialDesign:Card Margin="0,0,0,8" 
                                           materialDesign:ShadowAssist.ShadowDepth="Depth2">
                            <Expander Header="Мониторинг производительности" IsExpanded="False"
                                    materialDesign:ExpanderAssist.HorizontalHeaderPadding="16,8">
                                <StackPanel Margin="16">
                                    <Grid>
                                        <Grid.ColumnDefinitions>
                                            <ColumnDefinition Width="*"/>
                                            <ColumnDefinition Width="Auto"/>
                                        </Grid.ColumnDefinitions>
                                        <Grid.RowDefinitions>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                            <RowDefinition Height="Auto"/>
                                        </Grid.RowDefinitions>
                                        
                                        <TextBlock Grid.Row="0" Grid.Column="0" Text="Использование памяти:"/>
                                        <TextBlock Grid.Row="0" Grid.Column="1" Text="{Binding PerformanceMetrics.MemoryUsageMB, StringFormat='{}{0:F1} MB'}" 
                                                 FontWeight="SemiBold"/>
                                        
                                        <TextBlock Grid.Row="1" Grid.Column="0" Text="Активных операций:"/>
                                        <TextBlock Grid.Row="1" Grid.Column="1" Text="{Binding PerformanceMetrics.ActiveOperations}" 
                                                 FontWeight="SemiBold"/>
                                        
                                        <TextBlock Grid.Row="2" Grid.Column="0" Text="Время последней операции:"/>
                                        <TextBlock Grid.Row="2" Grid.Column="1" Text="{Binding PerformanceMetrics.LastOperationTime, StringFormat='{}{0:F0} мс'}" 
                                                 FontWeight="SemiBold"/>
                                        
                                        <TextBlock Grid.Row="3" Grid.Column="0" Text="Строк кода:"/>
                                        <TextBlock Grid.Row="3" Grid.Column="1" Text="{Binding PerformanceMetrics.TotalCodeLines}" 
                                                 FontWeight="SemiBold"/>
                                    </Grid>
                                </StackPanel>
                            </Expander>
                        </materialDesign:Card>

                    </StackPanel>
                </ScrollViewer>

                <!-- Splitter -->
                <GridSplitter Grid.Column="1" HorizontalAlignment="Stretch" 
                            Background="{DynamicResource MaterialDesignDivider}"/>

                <!-- Right Panel - Visualization and Results -->
                <Grid Grid.Column="2">
                    <materialDesign:Card materialDesign:ShadowAssist.ShadowDepth="Depth2">
                        <TabControl materialDesign:ColorZoneAssist.Mode="PrimaryMid"
                                  Style="{StaticResource MaterialDesignFilledTabControl}">
                            
                            <TabItem Header="Визуализация">
                                <Grid Margin="16">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Chart Toolbar -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                                        <Button Content="Открыть график в браузере" 
                                              Style="{StaticResource MaterialDesignRaisedButton}"
                                              IsEnabled="False" Margin="0,0,8,0"/>
                                        <Button Content="Экспорт графика" 
                                              Style="{StaticResource MaterialDesignOutlinedButton}"
                                              IsEnabled="False"/>
                                    </StackPanel>
                                    
                                    <!-- Chart Area Placeholder -->
                                    <Border Grid.Row="1" 
                                          Background="{DynamicResource MaterialDesignCardBackground}"
                                          BorderBrush="{DynamicResource MaterialDesignDivider}"
                                          BorderThickness="1"
                                          CornerRadius="4">
                                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                            <materialDesign:PackIcon Kind="ChartLine" Width="64" Height="64" 
                                                                   Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                                            <TextBlock Text="График будет отображен здесь" 
                                                     Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                     FontStyle="Italic" Margin="0,8,0,0"/>
                                            <TextBlock Text="Загрузите данные и выполните анализ" 
                                                     Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                     FontSize="12" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    
                                    <!-- Chart Info -->
                                    <Expander Grid.Row="2" Header="Информация о графике" 
                                            Margin="0,16,0,0" IsExpanded="False">
                                        <TextBlock Text="Здесь будет отображена информация о построенном графике"
                                                 TextWrapping="Wrap" Margin="16"/>
                                    </Expander>
                                </Grid>
                            </TabItem>
                            
                            <TabItem Header="Статистика">
                                <ScrollViewer Margin="16">
                                    <StackPanel>
                                        <TextBlock Text="Статистика анализа" 
                                                 Style="{StaticResource SectionHeaderStyle}"/>
                                        <TextBlock Text="Выполните анализ участка для получения статистики"
                                                 Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                 FontStyle="Italic"/>
                                    </StackPanel>
                                </ScrollViewer>
                            </TabItem>
                            
                            <TabItem Header="Данные">
                                <Grid Margin="16">
                                    <Grid.RowDefinitions>
                                        <RowDefinition Height="Auto"/>
                                        <RowDefinition Height="*"/>
                                        <RowDefinition Height="Auto"/>
                                    </Grid.RowDefinitions>
                                    
                                    <!-- Data Toolbar -->
                                    <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,16">
                                        <Button Content="Экспорт в Excel" 
                                              Style="{StaticResource MaterialDesignRaisedButton}"
                                              IsEnabled="False" Margin="0,0,8,0"/>
                                        <Button Content="Статистика маршрутов" 
                                              Style="{StaticResource MaterialDesignOutlinedButton}"
                                              IsEnabled="False"/>
                                    </StackPanel>
                                    
                                    <!-- Data Grid Placeholder -->
                                    <Border Grid.Row="1" 
                                          Background="{DynamicResource MaterialDesignCardBackground}"
                                          BorderBrush="{DynamicResource MaterialDesignDivider}"
                                          BorderThickness="1"
                                          CornerRadius="4">
                                        <StackPanel VerticalAlignment="Center" HorizontalAlignment="Center">
                                            <materialDesign:PackIcon Kind="TableLarge" Width="64" Height="64" 
                                                                   Foreground="{DynamicResource MaterialDesignBodyLight}"/>
                                            <TextBlock Text="Таблица данных будет отображена здесь" 
                                                     Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                     FontStyle="Italic" Margin="0,8,0,0"/>
                                            <TextBlock Text="Загрузите HTML файлы маршрутов" 
                                                     Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                     FontSize="12" HorizontalAlignment="Center"/>
                                        </StackPanel>
                                    </Border>
                                    
                                    <!-- Data Summary -->
                                    <materialDesign:Card Grid.Row="2" Margin="0,16,0,0" 
                                                       materialDesign:ShadowAssist.ShadowDepth="Depth1">
                                        <Grid Margin="16">
                                            <Grid.ColumnDefinitions>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                                <ColumnDefinition Width="*"/>
                                            </Grid.ColumnDefinitions>
                                            
                                            <StackPanel Grid.Column="0" HorizontalAlignment="Center">
                                                <TextBlock Text="0" FontSize="24" FontWeight="Bold" 
                                                         HorizontalAlignment="Center"/>
                                                <TextBlock Text="Маршрутов" FontSize="12" 
                                                         Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                         HorizontalAlignment="Center"/>
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="1" HorizontalAlignment="Center">
                                                <TextBlock Text="0" FontSize="24" FontWeight="Bold" 
                                                         HorizontalAlignment="Center"/>
                                                <TextBlock Text="Участков" FontSize="12" 
                                                         Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                         HorizontalAlignment="Center"/>
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="2" HorizontalAlignment="Center">
                                                <TextBlock Text="0" FontSize="24" FontWeight="Bold" 
                                                         HorizontalAlignment="Center"/>
                                                <TextBlock Text="Норм" FontSize="12" 
                                                         Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                         HorizontalAlignment="Center"/>
                                            </StackPanel>
                                            
                                            <StackPanel Grid.Column="3" HorizontalAlignment="Center">
                                                <TextBlock Text="0%" FontSize="24" FontWeight="Bold" 
                                                         HorizontalAlignment="Center"/>
                                                <TextBlock Text="Готовность" FontSize="12" 
                                                         Foreground="{DynamicResource MaterialDesignBodyLight}"
                                                         HorizontalAlignment="Center"/>
                                            </StackPanel>
                                        </Grid>
                                    </materialDesign:Card>
                                </Grid>
                            </TabItem>
                            
                        </TabControl>
                    </materialDesign:Card>
                </Grid>

            </Grid>

            <!-- Status Bar -->
            <materialDesign:Card Grid.Row="2" Margin="8,4,8,8" 
                               materialDesign:ShadowAssist.ShadowDepth="Depth1">
                <Grid Margin="16,8">
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="0" Orientation="Horizontal">
                        <materialDesign:PackIcon Kind="Information" Width="16" Height="16" 
                                               VerticalAlignment="Center" Margin="0,0,8,0"/>
                        <TextBlock Text="{Binding StatusMessage, FallbackValue='Готов к работе'}" 
                                 Style="{StaticResource StatusBarTextStyle}"/>
                    </StackPanel>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <TextBlock Text="{Binding PerformanceMetrics.MemoryUsageMB, StringFormat='Память: {0:F1} MB'}" 
                                 Style="{StaticResource StatusBarTextStyle}"/>
                        <Rectangle Width="1" Margin="8,2" 
                                 Fill="{DynamicResource MaterialDesignDivider}"/>
                        <TextBlock Text="{Binding CurrentTime, StringFormat='HH:mm:ss'}" 
                                 Style="{StaticResource StatusBarTextStyle}"/>
                    </StackPanel>
                </Grid>
            </materialDesign:Card>

        </Grid>
    </materialDesign:DialogHost>

</Window>
                                