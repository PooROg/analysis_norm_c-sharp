<!--MainWindow.xaml - Ð¤Ð˜ÐÐÐ›Ð¬ÐÐžÐ• Ð˜Ð¡ÐŸÐ ÐÐ’Ð›Ð•ÐÐ˜Ð• Ð´Ð»Ñ Ð­Ñ‚Ð°Ð¿Ð° 2: ÑƒÐ±Ñ€Ð°Ð½Ñ‹ Ð²ÑÐµ Ð¿Ñ€Ð¾Ð±Ð»ÐµÐ¼Ð½Ñ‹Ðµ ÑÑ‚Ð¸Ð»Ð¸-->
<Window x:Class="AnalysisNorm.MainWindow"
        xmlns="http://schemas.microsoft.com/winfx/2006/xaml/presentation"
        xmlns:x="http://schemas.microsoft.com/winfx/2006/xaml"
        xmlns:materialDesign="http://materialdesigninxaml.net/winfx/xaml/themes"
        Title="ÐÐ½Ð°Ð»Ð¸Ð·Ð°Ñ‚Ð¾Ñ€ Ð½Ð¾Ñ€Ð¼ Ñ€Ð°ÑÑ…Ð¾Ð´Ð° ÑÐ»ÐµÐºÑ‚Ñ€Ð¾ÑÐ½ÐµÑ€Ð³Ð¸Ð¸ Ð Ð–Ð” v3.4 (Ð­Ñ‚Ð°Ð¿ 2 - Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð¾ÑˆÐ¸Ð±ÐºÐ¸)"
        MinWidth="1400" MinHeight="900"
        Width="1600" Height="1000"
        WindowStartupLocation="CenterScreen"
        Background="White"
        FontSize="14">

    <Window.Resources>
        <!-- Ð£Ð¿Ñ€Ð¾Ñ‰ÐµÐ½Ð½Ñ‹Ðµ ÑÑ‚Ð¸Ð»Ð¸ Ð±ÐµÐ· Ð·Ð°Ð²Ð¸ÑÐ¸Ð¼Ð¾ÑÑ‚ÐµÐ¹ Ð¾Ñ‚ Material Design -->
        <Style x:Key="SectionHeaderStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="16"/>
            <Setter Property="FontWeight" Value="SemiBold"/>
            <Setter Property="Margin" Value="0,0,0,8"/>
            <Setter Property="Foreground" Value="#FF6750A4"/>
        </Style>
        
        <Style x:Key="StatusBarTextStyle" TargetType="TextBlock">
            <Setter Property="FontSize" Value="12"/>
            <Setter Property="Margin" Value="8,0"/>
            <Setter Property="VerticalAlignment" Value="Center"/>
        </Style>

        <Style x:Key="CardStyle" TargetType="Border">
            <Setter Property="Background" Value="White"/>
            <Setter Property="BorderBrush" Value="#FFDDDDDD"/>
            <Setter Property="BorderThickness" Value="1"/>
            <Setter Property="CornerRadius" Value="4"/>
            <Setter Property="Padding" Value="16"/>
            <Setter Property="Margin" Value="4"/>
        </Style>

        <!-- Ð‘Ð°Ð·Ð¾Ð²Ñ‹Ðµ ÐºÐ¾Ð½Ð²ÐµÑ€Ñ‚ÐµÑ€Ñ‹ (Ð²ÑÑ‚Ñ€Ð¾ÐµÐ½Ð½Ñ‹Ðµ Ð² WPF) -->
        <BooleanToVisibilityConverter x:Key="BooleanToVisibilityConverter"/>

    </Window.Resources>

    <Grid>
        <Grid.RowDefinitions>
            <RowDefinition Height="Auto"/> <!-- Toolbar -->
            <RowDefinition Height="*"/>    <!-- Main Content -->
            <RowDefinition Height="Auto"/> <!-- Status Bar -->
        </Grid.RowDefinitions>

        <!-- Toolbar -->
        <Border Grid.Row="0" Style="{StaticResource CardStyle}" Margin="8,8,8,4">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="ðŸ“Š" FontSize="20" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBlock Text="ÐÐ½Ð°Ð»Ð¸Ð·Ð°Ñ‚Ð¾Ñ€ Ð½Ð¾Ñ€Ð¼ Ñ€Ð°ÑÑ…Ð¾Ð´Ð° ÑÐ»ÐµÐºÑ‚Ñ€Ð¾ÑÐ½ÐµÑ€Ð³Ð¸Ð¸ Ð Ð–Ð”" 
                         Style="{StaticResource SectionHeaderStyle}"
                         VerticalAlignment="Center"/>
                
                <!-- Spacer -->
                <Border Width="32"/>
                
                <!-- Quick Actions - Ð¿Ñ€Ð¾ÑÑ‚Ñ‹Ðµ ÐºÐ½Ð¾Ð¿ÐºÐ¸ -->
                <Button Content="Ð”Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸ÐºÐ°" Margin="4,0"
                        ToolTip="ÐŸÐ¾ÐºÐ°Ð·Ð°Ñ‚ÑŒ Ð´Ð¸Ð°Ð³Ð½Ð¾ÑÑ‚Ð¸Ñ‡ÐµÑÐºÑƒÑŽ Ð¿Ð°Ð½ÐµÐ»ÑŒ"/>
                
                <Button Content="Ðž Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ðµ" Margin="4,0"
                        ToolTip="Ðž Ð¿Ñ€Ð¾Ð³Ñ€Ð°Ð¼Ð¼Ðµ"/>
            </StackPanel>
        </Border>

        <!-- Main Content Area -->
        <Grid Grid.Row="1" Margin="8,4,8,4">
            <Grid.ColumnDefinitions>
                <ColumnDefinition Width="350"/> <!-- Left Panel -->
                <ColumnDefinition Width="8"/>   <!-- Splitter -->
                <ColumnDefinition Width="*"/>   <!-- Right Panel -->
            </Grid.ColumnDefinitions>

            <!-- Left Panel - Controls and Configuration -->
            <ScrollViewer Grid.Column="0" VerticalScrollBarVisibility="Auto">
                <StackPanel>
                    
                    <!-- File Section -->
                    <Border Style="{StaticResource CardStyle}" Margin="0,0,0,8">
                        <Expander Header="Ð¤Ð°Ð¹Ð»Ñ‹ Ð´Ð°Ð½Ð½Ñ‹Ñ…" IsExpanded="True">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="HTML Ñ„Ð°Ð¹Ð»Ñ‹ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð¾Ð²:" FontWeight="SemiBold"/>
                                <TextBlock Text="ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ñ‹" Foreground="Gray" Margin="0,4,0,8"/>
                                <StackPanel Orientation="Horizontal" Margin="0,0,0,16">
                                    <Button Content="Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ HTML Ñ„Ð°Ð¹Ð»Ñ‹"
                                            ToolTip="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ HTML Ñ„Ð°Ð¹Ð»Ñ‹ Ñ Ð´Ð°Ð½Ð½Ñ‹Ð¼Ð¸ Ð¾ Ð¼Ð°Ñ€ÑˆÑ€ÑƒÑ‚Ð°Ñ…"/>
                                    <Button Content="ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ" Margin="8,0,0,0"/>
                                </StackPanel>
                                
                                <TextBlock Text="Excel Ñ„Ð°Ð¹Ð»Ñ‹ Ð½Ð¾Ñ€Ð¼:" FontWeight="SemiBold"/>
                                <TextBlock Text="ÐÐµ Ð²Ñ‹Ð±Ñ€Ð°Ð½Ñ‹" Foreground="Gray" Margin="0,4,0,8"/>
                                <StackPanel Orientation="Horizontal">
                                    <Button Content="Ð’Ñ‹Ð±Ñ€Ð°Ñ‚ÑŒ Excel Ñ„Ð°Ð¹Ð»Ñ‹"
                                            ToolTip="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Excel Ñ„Ð°Ð¹Ð»Ñ‹ Ñ Ð½Ð¾Ñ€Ð¼Ð°Ð¼Ð¸ Ñ€Ð°ÑÑ…Ð¾Ð´Ð°"/>
                                    <Button Content="ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ" Margin="8,0,0,0"/>
                                </StackPanel>
                            </StackPanel>
                        </Expander>
                    </Border>

                    <!-- Analysis Section -->
                    <Border Style="{StaticResource CardStyle}" Margin="0,0,0,8">
                        <Expander Header="ÐÐ½Ð°Ð»Ð¸Ð·" IsExpanded="True">
                            <StackPanel Margin="0,8,0,0">
                                <TextBlock Text="Ð£Ñ‡Ð°ÑÑ‚Ð¾Ðº Ð´Ð»Ñ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°:" FontWeight="SemiBold"/>
                                <ComboBox Margin="0,4,0,16">
                                    <ComboBoxItem Content="Ð£Ñ‡Ð°ÑÑ‚Ð¾Ðº 1"/>
                                    <ComboBoxItem Content="Ð£Ñ‡Ð°ÑÑ‚Ð¾Ðº 2"/>
                                    <ComboBoxItem Content="Ð£Ñ‡Ð°ÑÑ‚Ð¾Ðº 3"/>
                                </ComboBox>
                                
                                <Button Content="Ð—Ð°Ð³Ñ€ÑƒÐ·Ð¸Ñ‚ÑŒ Ð½Ð¾Ñ€Ð¼Ñ‹ Ð¸Ð· HTML" Margin="0,0,0,8"/>
                                <Button Content="ÐÐ½Ð°Ð»Ð¸Ð·Ð¸Ñ€Ð¾Ð²Ð°Ñ‚ÑŒ ÑƒÑ‡Ð°ÑÑ‚Ð¾Ðº" Margin="0,0,0,8"/>
                                <Button Content="Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð² Excel"/>
                            </StackPanel>
                        </Expander>
                    </Border>

                    <!-- Processing Configuration -->
                    <Border Style="{StaticResource CardStyle}" Margin="0,0,0,8">
                        <Expander Header="ÐÐ°ÑÑ‚Ñ€Ð¾Ð¹ÐºÐ¸ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸" IsExpanded="False">
                            <StackPanel Margin="0,8,0,0">
                                <CheckBox Content="Ð’ÐºÐ»ÑŽÑ‡Ð¸Ñ‚ÑŒ Ð´ÐµÑ‚Ð°Ð»ÑŒÐ½Ð¾Ðµ Ð»Ð¾Ð³Ð¸Ñ€Ð¾Ð²Ð°Ð½Ð¸Ðµ" IsChecked="True" Margin="0,4"/>
                                <CheckBox Content="ÐÐ²Ñ‚Ð¾Ð¼Ð°Ñ‚Ð¸Ñ‡ÐµÑÐºÐ¸Ð¹ ÑÐºÑÐ¿Ð¾Ñ€Ñ‚ Ñ€ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ð¾Ð²" Margin="0,4"/>
                                <CheckBox Content="ÐœÐ¾Ð½Ð¸Ñ‚Ð¾Ñ€Ð¸Ð½Ð³ Ð¿Ñ€Ð¾Ð¸Ð·Ð²Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒÐ½Ð¾ÑÑ‚Ð¸" IsChecked="True" Margin="0,4"/>
                                
                                <TextBlock Text="ÐœÐ°ÐºÑÐ¸Ð¼ÑƒÐ¼ Ð¾ÑˆÐ¸Ð±Ð¾Ðº:" FontWeight="SemiBold" Margin="0,16,0,4"/>
                                <Slider Minimum="1" Maximum="100" Value="10" 
                                        TickFrequency="10" IsSnapToTickEnabled="True"/>
                            </StackPanel>
                        </Expander>
                    </Border>

                </StackPanel>
            </ScrollViewer>

            <!-- Splitter -->
            <GridSplitter Grid.Column="1" Width="8" HorizontalAlignment="Stretch" 
                        Background="#FFDDDDDD"/>

            <!-- Right Panel - Results and Processing Status -->
            <Grid Grid.Column="2">
                <Grid.RowDefinitions>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="*"/>
                    <RowDefinition Height="Auto"/>
                    <RowDefinition Height="300"/>
                </Grid.RowDefinitions>

                <!-- Processing Progress -->
                <Border Grid.Row="0" Style="{StaticResource CardStyle}" Margin="0,0,0,8">
                    <StackPanel>
                        <TextBlock Text="ÐŸÑ€Ð¾Ñ†ÐµÑÑ Ð¾Ð±Ñ€Ð°Ð±Ð¾Ñ‚ÐºÐ¸" Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <!-- Progress Indicator -->
                        <StackPanel Orientation="Horizontal" Margin="0,8">
                            <TextBlock Text="Ð¡Ð¾ÑÑ‚Ð¾ÑÐ½Ð¸Ðµ:" Margin="0,0,8,0"/>
                            <TextBlock Text="ÐžÐ¶Ð¸Ð´Ð°Ð½Ð¸Ðµ" FontWeight="SemiBold"/>
                        </StackPanel>
                        
                        <ProgressBar Value="0" Minimum="0" Maximum="100" 
                                   Height="6" Margin="0,8"/>
                        
                        <TextBlock Text="Ð“Ð¾Ñ‚Ð¾Ð² Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ðµ" 
                                 Style="{StaticResource StatusBarTextStyle}"
                                 Margin="0,4,0,0"/>
                    </StackPanel>
                </Border>

                <!-- Results Area -->
                <Border Grid.Row="1" Style="{StaticResource CardStyle}" Margin="0,0,0,8">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                        </Grid.RowDefinitions>
                        
                        <TextBlock Grid.Row="0" Text="Ð ÐµÐ·ÑƒÐ»ÑŒÑ‚Ð°Ñ‚Ñ‹ Ð°Ð½Ð°Ð»Ð¸Ð·Ð°" 
                                 Style="{StaticResource SectionHeaderStyle}"/>
                        
                        <ScrollViewer Grid.Row="1" Margin="0,8,0,0">
                            <StackPanel>
                                <TextBlock Text="ÐÐ½Ð°Ð»Ð¸Ð· Ð½Ðµ Ð²Ñ‹Ð¿Ð¾Ð»Ð½ÐµÐ½" 
                                         FontSize="16"
                                         Foreground="Gray" 
                                         TextAlignment="Center"
                                         Margin="0,50"/>
                                <TextBlock Text="Ð’Ñ‹Ð±ÐµÑ€Ð¸Ñ‚Ðµ Ñ„Ð°Ð¹Ð»Ñ‹ Ð¸ Ð·Ð°Ð¿ÑƒÑÑ‚Ð¸Ñ‚Ðµ Ð°Ð½Ð°Ð»Ð¸Ð·" 
                                         FontSize="14"
                                         Foreground="Gray" 
                                         TextAlignment="Center"/>
                            </StackPanel>
                        </ScrollViewer>
                    </Grid>
                </Border>

                <!-- Splitter -->
                <GridSplitter Grid.Row="2" Height="8" HorizontalAlignment="Stretch"
                            Background="#FFDDDDDD"/>

                <!-- Log Panel -->
                <Border Grid.Row="3" Style="{StaticResource CardStyle}">
                    <Grid>
                        <Grid.RowDefinitions>
                            <RowDefinition Height="Auto"/>
                            <RowDefinition Height="*"/>
                            <RowDefinition Height="Auto"/>
                        </Grid.RowDefinitions>
                        
                        <StackPanel Grid.Row="0" Orientation="Horizontal" Margin="0,0,0,8">
                            <TextBlock Text="Ð–ÑƒÑ€Ð½Ð°Ð» Ð¾Ð¿ÐµÑ€Ð°Ñ†Ð¸Ð¹" Style="{StaticResource SectionHeaderStyle}"/>
                            <Border Width="16"/>
                            <Button Content="ÐžÑ‡Ð¸ÑÑ‚Ð¸Ñ‚ÑŒ" Height="28" Padding="12,4"/>
                            <Button Content="Ð­ÐºÑÐ¿Ð¾Ñ€Ñ‚ Ð»Ð¾Ð³Ð¾Ð²" Height="28" Padding="12,4" Margin="8,0,0,0"/>
                        </StackPanel>
                        
                        <ScrollViewer Grid.Row="1" Margin="0,0,0,8"
                                    VerticalScrollBarVisibility="Auto">
                            <ItemsControl>
                                <!-- ÐŸÑ€Ð¸Ð¼ÐµÑ€ Ð·Ð°Ð¿Ð¸ÑÐµÐ¹ Ð»Ð¾Ð³Ð° -->
                                <StackPanel Orientation="Horizontal" Margin="0,2">
                                    <TextBlock Text="[12:34:56]" Foreground="Gray" Width="80"/>
                                    <TextBlock Text="Ð˜Ð½Ñ„Ð¾" Foreground="Blue" Width="60"/>
                                    <TextBlock Text="ÐŸÑ€Ð¸Ð»Ð¾Ð¶ÐµÐ½Ð¸Ðµ Ð·Ð°Ð¿ÑƒÑ‰ÐµÐ½Ð¾ ÑƒÑÐ¿ÐµÑˆÐ½Ð¾"/>
                                </StackPanel>
                                <StackPanel Orientation="Horizontal" Margin="0,2">
                                    <TextBlock Text="[12:34:57]" Foreground="Gray" Width="80"/>
                                    <TextBlock Text="ÐžÑ‚Ð»Ð°Ð´ÐºÐ°" Foreground="Green" Width="60"/>
                                    <TextBlock Text="Ð˜Ð½Ð¸Ñ†Ð¸Ð°Ð»Ð¸Ð·Ð°Ñ†Ð¸Ñ ÐºÐ¾Ð¼Ð¿Ð¾Ð½ÐµÐ½Ñ‚Ð¾Ð² Ð·Ð°Ð²ÐµÑ€ÑˆÐµÐ½Ð°"/>
                                </StackPanel>
                            </ItemsControl>
                        </ScrollViewer>
                        
                        <Border Grid.Row="2" Background="#FFF0F0F0" Padding="8">
                            <StackPanel Orientation="Horizontal">
                                <TextBlock Text="Ð—Ð°Ð¿Ð¸ÑÐµÐ¹ Ð² Ð¶ÑƒÑ€Ð½Ð°Ð»Ðµ: 2" 
                                         Style="{StaticResource StatusBarTextStyle}"/>
                                <Border Width="16"/>
                                <TextBlock Text="ÐŸÐ¾ÑÐ»ÐµÐ´Ð½ÐµÐµ Ð¾Ð±Ð½Ð¾Ð²Ð»ÐµÐ½Ð¸Ðµ: Ð½Ð¸ÐºÐ¾Ð³Ð´Ð°" 
                                         Style="{StaticResource StatusBarTextStyle}"/>
                            </StackPanel>
                        </Border>
                    </Grid>
                </Border>

            </Grid>
        </Grid>

        <!-- Status Bar -->
        <Border Grid.Row="2" Style="{StaticResource CardStyle}" Margin="8,4,8,8">
            <StackPanel Orientation="Horizontal">
                <TextBlock Text="âœ…" FontSize="16" VerticalAlignment="Center" Margin="0,0,8,0"/>
                <TextBlock Text="Ð“Ð¾Ñ‚Ð¾Ð² Ðº Ñ€Ð°Ð±Ð¾Ñ‚Ðµ" 
                         Style="{StaticResource StatusBarTextStyle}"/>
                
                <!-- Spacer -->
                <Border Width="32"/>
                
                <TextBlock Text="Ð’ÐµÑ€ÑÐ¸Ñ: 3.4.0 (Ð­Ñ‚Ð°Ð¿ 2 - Ð˜ÑÐ¿Ñ€Ð°Ð²Ð»ÐµÐ½Ñ‹ Ð¾ÑˆÐ¸Ð±ÐºÐ¸)" 
                         Style="{StaticResource StatusBarTextStyle}"/>
                
                <!-- Right aligned items -->
                <Grid>
                    <Grid.ColumnDefinitions>
                        <ColumnDefinition Width="*"/>
                        <ColumnDefinition Width="Auto"/>
                    </Grid.ColumnDefinitions>
                    
                    <StackPanel Grid.Column="1" Orientation="Horizontal">
                        <TextBlock Text="ÐŸÐ°Ð¼ÑÑ‚ÑŒ: N/A" 
                                 Style="{StaticResource StatusBarTextStyle}"/>
                        <Border Width="16"/>
                        <TextBlock Text="Ð’Ñ€ÐµÐ¼Ñ Ñ€Ð°Ð±Ð¾Ñ‚Ñ‹: 00:00:00" 
                                 Style="{StaticResource StatusBarTextStyle}"/>
                    </StackPanel>
                </Grid>
            </StackPanel>
        </Border>

    </Grid>
</Window>