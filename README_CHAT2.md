# –ß–ê–¢ 2 –ó–ê–í–ï–†–®–ï–ù: –•—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–æ—Ä–º + –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã + GUI —Å–µ–∫—Ü–∏—è "–§–∞–π–ª—ã"

## ‚úÖ –í—ã–ø–æ–ª–Ω–µ–Ω–æ (–ü—Ä–æ–≥—Ä–µ—Å—Å: 25%)

### –ë—ç–∫–µ–Ω–¥ –º–æ–¥—É–ª–∏

1. **Core/NormStorage.cs** (650 —Å—Ç—Ä–æ–∫)
   - ‚úÖ –ì–∏–ø–µ—Ä–±–æ–ª–∏—á–µ—Å–∫–∞—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è (1 —Ç–æ—á–∫–∞ ‚Üí –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞, 2+ —Ç–æ—á–∫–∏ ‚Üí –≥–∏–ø–µ—Ä–±–æ–ª–∞)
   - ‚úÖ JSON —Å–µ—Ä–∏–∞–ª–∏–∑–∞—Ü–∏—è (–≤–º–µ—Å—Ç–æ Python pickle)
   - ‚úÖ –ö—ç—à —Ñ—É–Ω–∫—Ü–∏–π –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏
   - ‚úÖ –í–∞–ª–∏–¥–∞—Ü–∏—è –Ω–æ—Ä–º
   - ‚úÖ –ü–æ–∏—Å–∫ –∏ —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

2. **Core/CoefficientsManager.cs** (420 —Å—Ç—Ä–æ–∫)
   - ‚úÖ –ó–∞–≥—Ä—É–∑–∫–∞ –∏–∑ Excel (–≤—Å–µ –ª–∏—Å—Ç—ã = —Å–µ—Ä–∏–∏ –ª–æ–∫–æ–º–æ—Ç–∏–≤–æ–≤)
   - ‚úÖ –ù–æ—Ä–º–∞–ª–∏–∑–∞—Ü–∏—è –Ω–∞–∑–≤–∞–Ω–∏–π —Å–µ—Ä–∏–π
   - ‚úÖ –ü–æ–¥–¥–µ—Ä–∂–∫–∞ –¥–≤—É—Ö –∏—Å—Ç–æ—á–Ω–∏–∫–æ–≤: "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç" –∏ "–ü—Ä–æ—Ü–µ–Ω—Ç"
   - ‚úÖ –§–∏–ª—å—Ç—Ä–∞—Ü–∏—è –ø–æ –º–∏–Ω–∏–º–∞–ª—å–Ω–æ–π —Ä–∞–±–æ—Ç–µ
   - ‚úÖ –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞ –æ—Ç–∫–ª–æ–Ω–µ–Ω–∏–π

3. **Core/LocomotiveFilter.cs** (280 —Å—Ç—Ä–æ–∫)
   - ‚úÖ 4 —Ä–µ–∂–∏–º–∞ —Ä–∞–±–æ—Ç—ã (Standard, Guess, Depot, Minimal)
   - ‚úÖ –ì—Ä—É–ø–ø–∏—Ä–æ–≤–∫–∞ –ª–æ–∫–æ–º–æ—Ç–∏–≤–æ–≤ –ø–æ —Å–µ—Ä–∏—è–º
   - ‚úÖ –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –≤—ã–±–æ—Ä–æ–º (SelectAll, DeselectAll, InvertSelection)
   - ‚ö†Ô∏è –ó–∞–≥–ª—É—à–∫–∞: –ü–æ–ª–Ω–∞—è —Ñ–∏–ª—å—Ç—Ä–∞—Ü–∏—è DataFrame ‚Üí –ß–∞—Ç 3

### GUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã

4. **GUI/Components/FileSection.cs** (400 —Å—Ç—Ä–æ–∫)
   - ‚úÖ –í—ã–±–æ—Ä HTML –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π)
   - ‚úÖ –í—ã–±–æ—Ä HTML –Ω–æ—Ä–º (–º–Ω–æ–∂–µ—Å—Ç–≤–µ–Ω–Ω—ã–π)
   - ‚úÖ –í—ã–±–æ—Ä Excel –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤
   - ‚úÖ –ö–Ω–æ–ø–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏ —Å —É–º–Ω–æ–π –∞–∫—Ç–∏–≤–∞—Ü–∏–µ–π
   - ‚úÖ –°—Ç–∞—Ç—É—Å —Å —Ü–≤–µ—Ç–æ–≤–æ–π –∏–Ω–¥–∏–∫–∞—Ü–∏–µ–π
   - ‚ö†Ô∏è –ó–∞–≥–ª—É—à–∫–∞: –†–µ–∞–ª—å–Ω–∞—è –∑–∞–≥—Ä—É–∑–∫–∞ HTML ‚Üí –ß–∞—Ç 3

### NuGet –ø–∞–∫–µ—Ç—ã

- ‚úÖ **MathNet.Numerics** - –ú–∞—Ç–µ–º–∞—Ç–∏–∫–∞ –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏
- ‚úÖ **ClosedXML** - –ß—Ç–µ–Ω–∏–µ Excel —Ñ–∞–π–ª–æ–≤

---

## üìã –§–∞–π–ª—ã –¥–ª—è –¥–æ–±–∞–≤–ª–µ–Ω–∏—è –≤ –ø—Ä–æ–µ–∫—Ç

–°–∫–æ–ø–∏—Ä—É–π—Ç–µ —Ñ–∞–π–ª—ã –≤ Visual Studio –ø—Ä–æ–µ–∫—Ç:

```
analysis_norm_c-sharp/
‚îú‚îÄ‚îÄ Core/
‚îÇ   ‚îú‚îÄ‚îÄ NormStorage.cs           ‚Üê –ù–û–í–´–ô
‚îÇ   ‚îú‚îÄ‚îÄ CoefficientsManager.cs   ‚Üê –ù–û–í–´–ô
‚îÇ   ‚îî‚îÄ‚îÄ LocomotiveFilter.cs      ‚Üê –ù–û–í–´–ô
‚îú‚îÄ‚îÄ GUI/
‚îÇ   ‚îî‚îÄ‚îÄ Components/
‚îÇ       ‚îî‚îÄ‚îÄ FileSection.cs       ‚Üê –ù–û–í–´–ô
‚îî‚îÄ‚îÄ docs/
    ‚îú‚îÄ‚îÄ MIGRATION_LOG.md         ‚Üê –û–ë–ù–û–í–õ–ï–ù
    ‚îú‚îÄ‚îÄ INSTALL_NUGET_CHAT2.md   ‚Üê –ù–û–í–´–ô
    ‚îî‚îÄ‚îÄ INTEGRATION_FILESECTION.md ‚Üê –ù–û–í–´–ô
```

---

## üöÄ –ò–Ω—Å—Ç—Ä—É–∫—Ü–∏—è –ø–æ –∑–∞–ø—É—Å–∫—É

### –®–∞–≥ 1: –£—Å—Ç–∞–Ω–æ–≤–∏—Ç—å NuGet –ø–∞–∫–µ—Ç—ã

```powershell
Install-Package MathNet.Numerics
Install-Package ClosedXML
```

–ò–ª–∏ —á–µ—Ä–µ–∑ GUI: Tools ‚Üí NuGet Package Manager ‚Üí Manage NuGet Packages

### –®–∞–≥ 2: –î–æ–±–∞–≤–∏—Ç—å —Ñ–∞–π–ª—ã –≤ –ø—Ä–æ–µ–∫—Ç

1. –°–æ–∑–¥–∞—Ç—å –ø–∞–ø–∫–∏: `Core/`, `GUI/Components/`
2. –î–æ–±–∞–≤–∏—Ç—å –≤—Å–µ `.cs` —Ñ–∞–π–ª—ã –≤ –ø—Ä–æ–µ–∫—Ç
3. –£–±–µ–¥–∏—Ç—å—Å—è —á—Ç–æ namespace –∫–æ—Ä—Ä–µ–∫—Ç–Ω—ã–µ

### –®–∞–≥ 3: –ò–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞—Ç—å FileSection –≤ MainWindow

–°–ª–µ–¥–æ–≤–∞—Ç—å –∏–Ω—Å—Ç—Ä—É–∫—Ü–∏–∏: `INTEGRATION_FILESECTION.md`

–ö—Ä–∞—Ç–∫–æ:
```csharp
// –í MainWindow.cs –¥–æ–±–∞–≤–∏—Ç—å:
private FileSection _fileSection;

// –í SetupUI() –∑–∞–º–µ–Ω–∏—Ç—å placeholder:
_fileSection = new FileSection { Dock = DockStyle.Fill };
_fileSection.OnRoutesLoaded += FileSection_OnRoutesLoaded;
_fileSection.OnNormsLoaded += FileSection_OnNormsLoaded;
_fileSection.OnCoefficientsLoaded += FileSection_OnCoefficientsLoaded;

mainLayout.Controls.Add(_fileSection, 0, 0);
```

### –®–∞–≥ 4: –°–∫–æ–º–ø–∏–ª–∏—Ä–æ–≤–∞—Ç—å –∏ –∑–∞–ø—É—Å—Ç–∏—Ç—å

```bash
dotnet build
dotnet run
```

–ò–ª–∏ –≤ Visual Studio: F5

---

## ‚úÖ –ü—Ä–æ–≤–µ—Ä–∫–∞ —Ä–∞–±–æ—Ç—ã

–ü–æ—Å–ª–µ –∑–∞–ø—É—Å–∫–∞ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è:

### 1. –¢–µ—Å—Ç FileSection
- [ ] –õ–µ–≤–∞—è –ø–∞–Ω–µ–ª—å –ø–æ–∫–∞–∑—ã–≤–∞–µ—Ç "–§–∞–π–ª—ã –¥–∞–Ω–Ω—ã—Ö"
- [ ] –ö–Ω–æ–ø–∫–∏ "–í—ã–±—Ä–∞—Ç—å —Ñ–∞–π–ª—ã" –æ—Ç–∫—Ä—ã–≤–∞—é—Ç –¥–∏–∞–ª–æ–≥–∏
- [ ] –ü—Ä–∏ –≤—ã–±–æ—Ä–µ –æ—Ç–æ–±—Ä–∞–∂–∞—é—Ç—Å—è –∏–º–µ–Ω–∞ —Ñ–∞–π–ª–æ–≤
- [ ] –ö–Ω–æ–ø–∫–∏ "–ó–∞–≥—Ä—É–∑–∏—Ç—å" –∞–∫—Ç–∏–≤–∏—Ä—É—é—Ç—Å—è
- [ ] –ü—Ä–∏ –Ω–∞–∂–∞—Ç–∏–∏ "–ó–∞–≥—Ä—É–∑–∏—Ç—å" –æ–±–Ω–æ–≤–ª—è–µ—Ç—Å—è —Å—Ç–∞—Ç—É—Å

### 2. –¢–µ—Å—Ç NormStorage (–≤ –∫–æ–¥–µ)
```csharp
var storage = new NormStorage("test.json");
var testNorms = new Dictionary<string, NormData>
{
    ["123"] = new NormData
    {
        Points = new List<NormPoint>
        {
            new NormPoint(50, 100),
            new NormPoint(60, 90)
        }
    }
};
storage.AddOrUpdateNorms(testNorms);
var value = storage.InterpolateNormValue("123", 55); // –î–æ–ª–∂–Ω–æ –≤–µ—Ä–Ω—É—Ç—å ~95
```

### 3. –¢–µ—Å—Ç CoefficientsManager
–ü–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å —Ç–µ—Å—Ç–æ–≤—ã–π Excel —Ñ–∞–π–ª:
- –õ–∏—Å—Ç —Å –∏–º–µ–Ω–µ–º —Å–µ—Ä–∏–∏ (–Ω–∞–ø—Ä–∏–º–µ—Ä, "–í–õ80")
- –ö–æ–ª–æ–Ω–∫–∏: "–ó–∞–≤–æ–¥—Å–∫–æ–π –Ω–æ–º–µ—Ä –ª–æ–∫–æ–º–æ—Ç–∏–≤–∞", "–ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç"
- –ù–µ—Å–∫–æ–ª—å–∫–æ —Å—Ç—Ä–æ–∫ —Å –¥–∞–Ω–Ω—ã–º–∏

```csharp
var coeffManager = new CoefficientsManager();
bool loaded = coeffManager.LoadCoefficients("test_coefficients.xlsx");
if (loaded)
{
    double coef = coeffManager.GetCoefficient("–í–õ80", 1234); // –î–æ–ª–∂–µ–Ω –Ω–∞–π—Ç–∏
    var stats = coeffManager.GetStatistics();
}
```

---

## ‚ö†Ô∏è –ò–∑–≤–µ—Å—Ç–Ω—ã–µ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∏—è (–±—É–¥—É—Ç –∏—Å–ø—Ä–∞–≤–ª–µ–Ω—ã –≤ –ß–∞—Ç–µ 3)

1. **FileSection:**
   - –ö–Ω–æ–ø–∫–∏ "–ó–∞–≥—Ä—É–∑–∏—Ç—å –º–∞—Ä—à—Ä—É—Ç—ã/–Ω–æ—Ä–º—ã" —Ç–æ–ª—å–∫–æ –ª–æ–≥–∏—Ä—É—é—Ç —Ñ–∞–π–ª—ã
   - –ù–µ—Ç —Ä–µ–∞–ª—å–Ω–æ–≥–æ –ø–∞—Ä—Å–∏–Ω–≥–∞ HTML ‚Üí –î–æ–±–∞–≤–∏–º RouteProcessor/NormProcessor

2. **LocomotiveFilter:**
   - –ú–µ—Ç–æ–¥ `ExtractLocomotivesFromData()` –≤–æ–∑–≤—Ä–∞—â–∞–µ—Ç –∑–∞–≥–ª—É—à–∫–∏
   - –ú–µ—Ç–æ–¥ `FilterRoutes()` –≤—ã–±—Ä–∞—Å—ã–≤–∞–µ—Ç NotImplementedException
   - –ü–æ–ª–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞ DataFrame ‚Üí –î–æ–±–∞–≤–∏–º –≤ –ß–∞—Ç–µ 3

3. **–ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è:**
   - FileSection –Ω–µ –ø–æ–ª–Ω–æ—Å—Ç—å—é –∏–Ω—Ç–µ–≥—Ä–∏—Ä–æ–≤–∞–Ω –≤ MainWindow
   - –ù–µ—Ç —Å–≤—è–∑–∏ –º–µ–∂–¥—É —Å–µ–∫—Ü–∏—è–º–∏ ‚Üí –î–æ–±–∞–≤–∏–º –≤ –ß–∞—Ç–µ 3

---

## üìä –°—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

| –ú–µ—Ç—Ä–∏–∫–∞ | –ß–∞—Ç 1 | –ß–∞—Ç 2 | –ü—Ä–∏—Ä–æ—Å—Ç |
|---------|-------|-------|---------|
| –§–∞–π–ª–æ–≤ C# | 7 | 12 | +5 |
| –°—Ç—Ä–æ–∫ –∫–æ–¥–∞ | 865 | 2750 | +1885 (x3.2) |
| NuGet –ø–∞–∫–µ—Ç–æ–≤ | 4 | 6 | +2 |
| –ü—Ä–æ–≥—Ä–µ—Å—Å | 12.5% | 25% | +12.5% |

---

## üéØ –°–ª–µ–¥—É—é—â–∏–π —à–∞–≥: –ß–∞—Ç 3

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è:
- `Analysis/RouteProcessor.cs` - –ü–∞—Ä—Å–∏–Ω–≥ HTML –º–∞—Ä—à—Ä—É—Ç–æ–≤ (–±–æ–ª—å—à–æ–π —Ñ–∞–π–ª!)
- `Analysis/NormProcessor.cs` - –ü–∞—Ä—Å–∏–Ω–≥ HTML –Ω–æ—Ä–º
- `GUI/Components/ControlSection.cs` - –£–ø—Ä–∞–≤–ª–µ–Ω–∏–µ –∞–Ω–∞–ª–∏–∑–æ–º
- –ò–Ω—Ç–µ–≥—Ä–∞—Ü–∏—è: FileSection ‚Üí Processors ‚Üí ControlSection

### NuGet:
- HtmlAgilityPack (–ø–∞—Ä—Å–∏–Ω–≥ HTML)
- Microsoft.Data.Analysis (–∞–Ω–∞–ª–æ–≥ pandas)

---

## üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

### –ö–ª—é—á–µ–≤—ã–µ —Ä–µ—à–µ–Ω–∏—è:

1. **JSON –≤–º–µ—Å—Ç–æ pickle**
   - –ë–æ–ª–µ–µ –ø–µ—Ä–µ–Ω–æ—Å–∏–º–æ
   - –ß–∏—Ç–∞–µ–º–æ —á–µ–ª–æ–≤–µ–∫–æ–º
   - –°–æ–≤–º–µ—Å—Ç–∏–º–æ —Å web API

2. **ClosedXML –≤–º–µ—Å—Ç–æ EPPlus**
   - Open-source, –Ω–µ—Ç –ª–∏—Ü–µ–Ω–∑–∏–æ–Ω–Ω—ã—Ö –ø—Ä–æ–±–ª–µ–º
   - –•–æ—Ä–æ—à–∞—è –¥–æ–∫—É–º–µ–Ω—Ç–∞—Ü–∏—è
   - –ê–∫—Ç–∏–≤–Ω–∞—è –ø–æ–¥–¥–µ—Ä–∂–∫–∞

3. **–ú–ù–ö –≤—Ä—É—á–Ω—É—é –≤–º–µ—Å—Ç–æ scipy**
   - –ö–æ–Ω—Ç—Ä–æ–ª—å –Ω–∞–¥ –∞–ª–≥–æ—Ä–∏—Ç–º–æ–º
   - –ù–µ—Ç –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç –≤–Ω–µ—à–Ω–∏—Ö –±–∏–±–ª–∏–æ—Ç–µ–∫
   - –î–æ—Å—Ç–∞—Ç–æ—á–Ω–∞—è —Ç–æ—á–Ω–æ—Å—Ç—å –¥–ª—è –∑–∞–¥–∞—á–∏

4. **–ó–∞–≥–ª—É—à–∫–∏ –≤ LocomotiveFilter**
   - DataFrame –æ–ø–µ—Ä–∞—Ü–∏–∏ —Ç—Ä–µ–±—É—é—Ç Microsoft.Data.Analysis
   - –û—Ç–∫–ª–∞–¥—ã–≤–∞–µ–º –¥–æ –ß–∞—Ç–∞ 3 –∫–æ–≥–¥–∞ –±—É–¥—É—Ç –¥–∞–Ω–Ω—ã–µ –¥–ª—è —Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏—è

### –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ:
- –ò—Å–ø–æ–ª—å–∑–æ–≤–∞–ª–∏ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ –≤–º–µ—Å—Ç–æ unit-—Ç–µ—Å—Ç–æ–≤ (–ø–∞–º—è—Ç—å —á–∞—Ç–∞ –æ–≥—Ä–∞–Ω–∏—á–µ–Ω–∞)
- –¢–µ—Å—Ç—ã –≤ `Program.Main()` –ø–æ–¥ `#if DEBUG`
- –ü—Ä–æ–≤–µ—Ä–∫–∞ —á–µ—Ä–µ–∑ —Ä–µ–∞–ª—å–Ω—ã–π –∑–∞–ø—É—Å–∫ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è

---

## üîó –ü–æ–ª–µ–∑–Ω—ã–µ —Å—Å—ã–ª–∫–∏

- [MathNet.Numerics Documentation](https://numerics.mathdotnet.com/)
- [ClosedXML Documentation](https://docs.closedxml.io/)
- [–ü–ª–∞–Ω –º–∏–≥—Ä–∞—Ü–∏–∏ (8 —á–∞—Ç–æ–≤)](–ü–õ–ê–ù%20–ú–ò–ì–†–ê–¶–ò–ò%20(8%20–ß–ê–¢–û–í).txt)

---

**–ß–∞—Ç 2 —É—Å–ø–µ—à–Ω–æ –∑–∞–≤–µ—Ä—à–µ–Ω! –ì–æ—Ç–æ–≤ –∫ –ø–µ—Ä–µ—Ö–æ–¥—É –Ω–∞ –ß–∞—Ç 3.** üéâ
