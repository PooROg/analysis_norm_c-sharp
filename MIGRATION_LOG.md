# Migration Log: analysis_norm_python ‚Üí AnalysisNorm (C#)

## –ü—Ä–æ–≥—Ä–µ—Å—Å: 12.5% (–ß–∞—Ç 1 –∏–∑ 8)

---

## –ß–∞—Ç 1 - 2025-01-XX

### ‚úÖ –†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ –ø–æ–ª–Ω–æ—Å—Ç—å—é

| Python —Ñ—É–Ω–∫—Ü–∏—è/–∫–ª–∞—Å—Å | –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ Python | C# –º–µ—Ç–æ–¥/–∫–ª–∞—Å—Å | –†–∞—Å–ø–æ–ª–æ–∂–µ–Ω–∏–µ C# | –°—Ç–∞—Ç—É—Å |
|---------------------|-------------------|---------------|----------------|--------|
| `AppConfig` | config.py:10-60 | `AppConfig` | Core/AppConfig.cs | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `AppConfig.create_default()` | config.py:42 | `AppConfig.CreateDefault()` | Core/AppConfig.cs:60 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `AppConfig.ensure_directories()` | config.py:51 | `AppConfig.EnsureDirectories()` | Core/AppConfig.cs:79 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `normalize_text()` | utils.py:20 | `TextUtils.NormalizeText()` | Utils/CommonUtils.cs:23 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `safe_float()` | utils.py:28 | `TextUtils.SafeFloat()` | Utils/CommonUtils.cs:37 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `safe_int()` | utils.py:65 | `TextUtils.SafeInt()` | Utils/CommonUtils.cs:99 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `safe_divide()` | utils.py:85 | `TextUtils.SafeDivide()` | Utils/CommonUtils.cs:113 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `format_number()` | utils.py:100 | `TextUtils.FormatNumber()` | Utils/CommonUtils.cs:132 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `StatusClassifier` | utils.py:120-175 | `StatusClassifier` | Utils/CommonUtils.cs:161-230 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `StatusClassifier.get_status()` | utils.py:125 | `StatusClassifier.GetStatus()` | Utils/CommonUtils.cs:181 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `StatusClassifier.get_status_color()` | utils.py:150 | `StatusClassifier.GetStatusColor()` | Utils/CommonUtils.cs:210 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `NormsAnalyzerGUI.__init__()` | interface.py:30-80 | `MainWindow (constructor)` | GUI/MainWindow.cs:25-40 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `NormsAnalyzerGUI._setup_gui()` | interface.py:45-150 | `MainWindow.SetupUI()` | GUI/MainWindow.cs:48-110 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `setup_logging()` | main.py:20-45 | `Program.SetupLogging()` | Program.cs:60-75 | ‚úÖ –ü–æ–ª–Ω–∞—è |
| `main()` | main.py:80-120 | `Program.Main()` | Program.cs:25-55 | ‚úÖ –ü–æ–ª–Ω–∞—è |

### üìÅ –°–æ–∑–¥–∞–Ω–Ω—ã–µ —Ñ–∞–π–ª—ã

- **AnalysisNorm.sln** - Solution —Ñ–∞–π–ª
- **Core/AppConfig.cs** (100 —Å—Ç—Ä–æ–∫) - –ö–æ–Ω—Ñ–∏–≥—É—Ä–∞—Ü–∏—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å –ø—É—Ç—è–º–∏ –∏ –∫–æ–Ω—Å—Ç–∞–Ω—Ç–∞–º–∏
- **Utils/CommonUtils.cs** (230 —Å—Ç—Ä–æ–∫) - –£—Ç–∏–ª–∏—Ç—ã –¥–ª—è —Ä–∞–±–æ—Ç—ã —Å —Ç–µ–∫—Å—Ç–æ–º –∏ –∫–ª–∞—Å—Å–∏—Ñ–∏–∫–∞—Ç–æ—Ä —Å—Ç–∞—Ç—É—Å–æ–≤
- **GUI/MainWindow.cs** (340 —Å—Ç—Ä–æ–∫) - –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ —Å —Ç—Ä–µ–º—è –ø–∞–Ω–µ–ª—è–º–∏-–∑–∞–≥–ª—É—à–∫–∞–º–∏
- **GUI/MainWindow.Designer.cs** (45 —Å—Ç—Ä–æ–∫) - Designer –∫–æ–¥ –¥–ª—è —Ñ–æ—Ä–º—ã
- **Program.cs** (150 —Å—Ç—Ä–æ–∫) - –¢–æ—á–∫–∞ –≤—Ö–æ–¥–∞ —Å –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏–µ–π –∏ —Ç–µ—Å—Ç–∞–º–∏
- **MIGRATION_LOG.md** - –≠—Ç–æ—Ç —Ñ–∞–π–ª

### üì¶ NuGet –ø–∞–∫–µ—Ç—ã

| –ü–∞–∫–µ—Ç | –í–µ—Ä—Å–∏—è | –ù–∞–∑–Ω–∞—á–µ–Ω–∏–µ |
|-------|--------|-----------|
| Serilog | 3.1.1 | –°—Ç—Ä—É–∫—Ç—É—Ä–∏—Ä–æ–≤–∞–Ω–Ω–æ–µ –ª–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ |
| Serilog.Sinks.File | 5.0.0 | –ó–∞–ø–∏—Å—å –ª–æ–≥–æ–≤ –≤ —Ñ–∞–π–ª—ã |
| Serilog.Sinks.Console | 5.0.1 | –í—ã–≤–æ–¥ –ª–æ–≥–æ–≤ –≤ –∫–æ–Ω—Å–æ–ª—å |
| Newtonsoft.Json | 13.0.3 | –†–∞–±–æ—Ç–∞ —Å JSON (–ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞) |

### üé® GUI —Å–æ—Å—Ç–æ—è–Ω–∏–µ

**–†–µ–∞–ª–∏–∑–æ–≤–∞–Ω–æ:**
- ‚úÖ –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ —Å –º–µ–Ω—é (–§–∞–π–ª, –ù–∞—Å—Ç—Ä–æ–π–∫–∏, –û –ø—Ä–æ–≥—Ä–∞–º–º–µ)
- ‚úÖ –°—Ç–∞—Ç—É—Å –±–∞—Ä
- ‚úÖ –¢—Ä–∏ –ø–∞–Ω–µ–ª–∏ —Å placeholder —Ç–µ–∫—Å—Ç–æ–º:
  - –°–µ–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (–ª–µ–≤–∞—è, 25%)
  - –°–µ–∫—Ü–∏—è —É–ø—Ä–∞–≤–ª–µ–Ω–∏—è –∞–Ω–∞–ª–∏–∑–æ–º (—Ü–µ–Ω—Ç—Ä, 30%)
  - –°–µ–∫—Ü–∏—è –≤–∏–∑—É–∞–ª–∏–∑–∞—Ü–∏–∏ (–ø—Ä–∞–≤–∞—è, 45%)
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –º–µ–Ω—é (–ø—É–Ω–∫—Ç—ã –æ—Ç–∫–ª—é—á–µ–Ω—ã —Å TODO)

**GUI —Å–∫—Ä–∏–Ω—à–æ—Ç —Å–æ—Å—Ç–æ—è–Ω–∏—è:** –ì–ª–∞–≤–Ω–æ–µ –æ–∫–Ω–æ —Ä–∞–∑–¥–µ–ª–µ–Ω–æ –Ω–∞ 3 —Å–µ–∫—Ü–∏–∏ —Å –æ–ø–∏—Å–∞–Ω–∏–µ–º –±—É–¥—É—â–µ–≥–æ —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–∞

### üìù –ü—Ä–∏–º–µ—á–∞–Ω–∏—è

**–û—Å–æ–±–µ–Ω–Ω–æ—Å—Ç–∏ —Ä–µ–∞–ª–∏–∑–∞—Ü–∏–∏:**
- –í—Å–µ –ø—É—Ç–∏ —á–µ—Ä–µ–∑ `AppConfig` (–∞–Ω–∞–ª–æ–≥ Python `Path`)
- –ö–æ–¥–∏—Ä–æ–≤–∫–∏ –∞–¥–∞–ø—Ç–∏—Ä–æ–≤–∞–Ω—ã: `cp1251` ‚Üí `windows-1251`
- –õ–æ–≥–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ Serilog (–∞–Ω–∞–ª–æ–≥ Python `logging`)
- WinForms –≤–º–µ—Å—Ç–æ tkinter
- –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ —á–µ—Ä–µ–∑ –≤—ã–∑–æ–≤—ã –≤ `Program.Main()` –≤–º–µ—Å—Ç–æ unit-—Ç–µ—Å—Ç–æ–≤

**–û—Ç–ª–∏—á–∏—è –æ—Ç Python:**
- –ò—Å–ø–æ–ª—å–∑—É—é—Ç—Å—è `TableLayoutPanel` –≤–º–µ—Å—Ç–æ tkinter grid/pack
- –ú–µ–Ω—é —Å–æ–∑–¥–∞–µ—Ç—Å—è –ø—Ä–æ–≥—Ä–∞–º–º–Ω–æ, –Ω–µ —á–µ—Ä–µ–∑ XAML
- –ù–µ—Ç –∞—Å–∏–Ω—Ö—Ä–æ–Ω–Ω–æ—Å—Ç–∏ (–ø–æ–∫–∞), threading –¥–æ–±–∞–≤–∏–º –≤ –ß–∞—Ç–µ 2-3

**–í–∞–ª–∏–¥–∞—Ü–∏—è:**
- ‚úÖ –ü—Ä–æ–µ–∫—Ç –∫–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –±–µ–∑ –æ—à–∏–±–æ–∫
- ‚úÖ –ü—Ä–∏–ª–æ–∂–µ–Ω–∏–µ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è
- ‚úÖ GUI –æ—Ç–æ–±—Ä–∞–∂–∞–µ—Ç—Å—è –∫–æ—Ä—Ä–µ–∫—Ç–Ω–æ
- ‚úÖ –õ–æ–≥–∏ –ø–∏—à—É—Ç—Å—è –≤ `logs/analyzer_YYYYMMDD.log`
- ‚úÖ –î–∏—Ä–µ–∫—Ç–æ—Ä–∏–∏ —Å–æ–∑–¥–∞—é—Ç—Å—è –∞–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏
- ‚úÖ –ë–∞–∑–æ–≤—ã–µ —É—Ç–∏–ª–∏—Ç—ã –ø—Ä–æ—Ç–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω—ã (–≤—ã–≤–æ–¥ –≤ –ª–æ–≥)

---

## –°–ª–µ–¥—É—é—â–∏–π: –ß–∞—Ç 2 - –•—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–æ—Ä–º + –ö–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç—ã + FileSection

### –ü–ª–∞–Ω–∏—Ä—É–µ—Ç—Å—è —Ä–µ–∞–ª–∏–∑–æ–≤–∞—Ç—å:

**Core –º–æ–¥—É–ª–∏:**
- `NormStorage.cs` - –•—Ä–∞–Ω–∏–ª–∏—â–µ –Ω–æ—Ä–º —Å –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–µ–π (scipy ‚Üí MathNet.Numerics)
- `CoefficientsManager.cs` - –ú–µ–Ω–µ–¥–∂–µ—Ä –∫–æ—ç—Ñ—Ñ–∏—Ü–∏–µ–Ω—Ç–æ–≤ –∏–∑ Excel
- `LocomotiveFilter.cs` - –§–∏–ª—å—Ç—Ä –ª–æ–∫–æ–º–æ—Ç–∏–≤–æ–≤ (4 —Ä–µ–∂–∏–º–∞)

**GUI –∫–æ–º–ø–æ–Ω–µ–Ω—Ç—ã:**
- `GUI/Components/FileSection.cs` - –°–µ–∫—Ü–∏—è –≤—ã–±–æ—Ä–∞ —Ñ–∞–π–ª–æ–≤ (–ª–µ–≤–∞—è –ø–∞–Ω–µ–ª—å)
  - –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ HTML –º–∞—Ä—à—Ä—É—Ç–æ–≤
  - –ö–Ω–æ–ø–∫–∏ –≤—ã–±–æ—Ä–∞ HTML –Ω–æ—Ä–º
  - –ö–Ω–æ–ø–∫–∏ –∑–∞–≥—Ä—É–∑–∫–∏
  - –°—Ç–∞—Ç—É—Å –∑–∞–≥—Ä—É–∑–∫–∏

**NuGet –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏:**
- MathNet.Numerics (–¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏)
- EPPlus –∏–ª–∏ ClosedXML (–¥–ª—è —á—Ç–µ–Ω–∏—è Excel)

**–ö—Ä–∏—Ç–µ—Ä–∏–∏ –≥–æ—Ç–æ–≤–Ω–æ—Å—Ç–∏ –ß–∞—Ç–∞ 2:**
- ‚úÖ NormStorage —Ä–∞–±–æ—Ç–∞–µ—Ç (–∑–∞–≥—Ä—É–∑–∫–∞, –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏—è)
- ‚úÖ CoefficientsManager —á–∏—Ç–∞–µ—Ç Excel
- ‚úÖ FileSection —Ñ—É–Ω–∫—Ü–∏–æ–Ω–∞–ª–µ–Ω (–≤—ã–±–æ—Ä —Ñ–∞–π–ª–æ–≤)
- ‚úÖ –ö–æ–º–ø–∏–ª–∏—Ä—É–µ—Ç—Å—è –∏ –∑–∞–ø—É—Å–∫–∞–µ—Ç—Å—è

---

## –ë–ª–æ–∫–µ—Ä—ã –∏ –≤–æ–ø—Ä–æ—Å—ã

**–¢–µ–∫—É—â–∏–µ –±–ª–æ–∫–µ—Ä—ã:** –ù–µ—Ç

**–í–æ–ø—Ä–æ—Å—ã –¥–ª—è —Å–ª–µ–¥—É—é—â–µ–≥–æ —á–∞—Ç–∞:**
1. –ö–∞–∫—É—é –±–∏–±–ª–∏–æ—Ç–µ–∫—É –∏—Å–ø–æ–ª—å–∑–æ–≤–∞—Ç—å –¥–ª—è –∏–Ω—Ç–µ—Ä–ø–æ–ª—è—Ü–∏–∏: MathNet.Numerics –∏–ª–∏ Accord.NET?
2. EPPlus –∏–ª–∏ ClosedXML –¥–ª—è Excel? (EPPlus —Ç—Ä–µ–±—É–µ—Ç –ª–∏—Ü–µ–Ω–∑–∏—é –¥–ª—è –∫–æ–º–º–µ—Ä—á–µ—Å–∫–æ–≥–æ –∏—Å–ø–æ–ª—å–∑–æ–≤–∞–Ω–∏—è)

---

## –û–±—â–∞—è —Å—Ç–∞—Ç–∏—Å—Ç–∏–∫–∞

- **–í—Å–µ–≥–æ —á–∞—Ç–æ–≤:** 8 –∑–∞–ø–ª–∞–Ω–∏—Ä–æ–≤–∞–Ω–æ
- **–ó–∞–≤–µ—Ä—à–µ–Ω–æ:** 1 (12.5%)
- **–°—Ç—Ä–æ–∫ C# –∫–æ–¥–∞:** ~865
- **–§–∞–π–ª–æ–≤ —Å–æ–∑–¥–∞–Ω–æ:** 7
- **NuGet –ø–∞–∫–µ—Ç–æ–≤:** 4